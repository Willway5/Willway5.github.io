<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="Keywords" content="blog"/>
    <meta name="Description" content="blog"/>
    <title>Simple</title>
    <link rel="shortcut icon" href="/static/favicon.png"/>
    <link rel="stylesheet" type="text/css" href="/main.css" />
</head>
<body>
<div class="main">
    <div class="header">
    	<ul id="pages">
            <li><a href="/">home</a></li>
            <li><a href="/#/tags">tags</a></li>
            <li><a href="/#/archive">archive</a></li>
    	</ul>
    </div>
	<div class="wrap-header">
	<h1>
    <a href="/" id="title"></a>
	</h1>
	</div>
<div id="md" style="display: none;">
<!-- markdown -->
ï¼ˆæ³¨æ˜ï¼šåŸæ–‡å‡ºè‡ªhttp://allluckly.cn/ios%E4%B9%8Bswift%E5%88%9D%E6%8E%A2/Swift%E7%BA%AF%E4%BB%A3%E7%A0%81%E8%B5%B0%E8%BF%9BUICollectionViewï¼Œè°¢è°¢ä½œè€…çš„æ— ç§åˆ†äº«ï¼Œè°¢è°¢ï¼ï¼‰
Swiftå¯¹äºä¸€é—¨æ–°çš„iOSç¼–ç¨‹è¯­è¨€ï¼Œä»–çš„å´›èµ·æ˜¯å¿…ç„¶çš„

æˆ‘ä»¬è¿™ç¾¤è€ç¨‹åºå‘˜ä»¬å­¦ä¹ æ–°çš„æŠ€èƒ½ä¹Ÿæ˜¯å¿…ç„¶çš„

ä¸æ¥å—æ–°æŠ€èƒ½å°†è¢«è¿™å¤§ç¾¤ä½“æ— æƒ…çš„æ·˜æ±°

So æˆ‘æ¬£ç„¶æ¥å—è¿™é—¨çœ‹ä¼¼ä¸æˆç†Ÿçš„è¯­è¨€

ä¸‹é¢æˆ‘ä»¬è¯´è¯´Swiftä¸­æ¯”è¾ƒå¸¸è§çš„æ§ä»¶UICollectionView

é¦–å…ˆæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªå…¨å±€çš„UICollectionViewå’Œä¸€ä¸ªæ•°æ®æº

var colltionView : UICollectionView?
var dataArr = NSMutableArray()

ç„¶åè®¾ç½®UICollectionViewçš„3ä¸ªä»£ç†
UICollectionViewDelegate,UICollectionViewDataSource,UICollectionViewDelegateFlowLayout
æ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„æ˜¯override func viewDidLoad()æ–¹æ³•ä¸­åˆå§‹åŒ–ä¸€äº›å¿…è¦çš„å¯¹è±¡

override func viewDidLoad() {
    super.viewDidLoad()
    var layout = UICollectionViewFlowLayout()
    colltionView = UICollectionView(frame: CGRectMake(0, 0, width, height), collectionViewLayout: layout)
    //æ³¨å†Œä¸€ä¸ªcell
    colltionView! .registerClass(Home_Cell.self, forCellWithReuseIdentifier:"cell")
    //æ³¨å†Œä¸€ä¸ªheadView
    colltionView! .registerClass(Home_HeadView.self, forSupplementaryViewOfKind:UICollectionElementKindSectionHeader, withReuseIdentifier: "headView")
    colltionView?.delegate = self;
    colltionView?.dataSource = self;

    colltionView?.backgroundColor = UIColor.whiteColor()
    //è®¾ç½®æ¯ä¸€ä¸ªcellçš„å®½é«˜
    layout.itemSize = CGSizeMake((width-30)/2, 250)
    self.view .addSubview(colltionView!)
    self .getData()
}
ç„¶åæˆ‘ä»¬å®ç°UICollectionViewçš„ä»£ç†æ–¹æ³•

//è¿”å›å¤šå°‘ä¸ªç»„
func numberOfSectionsInCollectionView(collectionView: UICollectionView) -> Int {

    return 1
}
//è¿”å›å¤šå°‘ä¸ªcell
func collectionView(collectionView: UICollectionView, numberOfItemsInSection section: Int) -> Int {
    return dataArr.count
}
//è¿”å›è‡ªå®šä¹‰çš„cell
func collectionView(collectionView: UICollectionView, cellForItemAtIndexPath indexPath: NSIndexPath) -> UICollectionViewCell {


    let cell = collectionView.dequeueReusableCellWithReuseIdentifier("cell", forIndexPath: indexPath) as! Home_Cell
    var model = GoodsModel()
    model = dataArr[indexPath.row] as! GoodsModel
    let url : NSURL = NSURL(string: model.image_url as String)!
    cell.imgView!.hnk_setImageFromURL(url)
    cell.layer.borderWidth = 0.3;
    cell.layer.borderColor = UIColor.lightGrayColor().CGColor
    cell.titleLabel!.text = model.short_name
    cell.priceLabel!.text = "ï¿¥"+model.p_price
    cell.readLabel!.text = "ğŸ’—"+model.like_count
    return cell
}
//è¿”å›HeadViewçš„å®½é«˜
func collectionView(collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, referenceSizeForHeaderInSection section: Int) -> CGSize{

    return CGSize(width: width, height: height/1.6)
}

//è¿”å›è‡ªå®šä¹‰HeadViewæˆ–è€…FootViewï¼Œæˆ‘è¿™é‡Œä»¥headviewä¸ºä¾‹
func collectionView(collectionView: UICollectionView, viewForSupplementaryElementOfKind kind: String, atIndexPath indexPath: NSIndexPath) -> UICollectionReusableView{
    var v = Home_HeadView()
    if kind == UICollectionElementKindSectionHeader{

    v = colltionView!.dequeueReusableSupplementaryViewOfKind(kind, withReuseIdentifier: "headView", forIndexPath: indexPath) as! Home_HeadView
    }
    return v
}
//è¿”å›cell ä¸Šä¸‹å·¦å³çš„é—´è·
func collectionView(collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, insetForSectionAtIndex section: Int) -> UIEdgeInsets{
    return UIEdgeInsetsMake(5, 10, 5, 10)
}
ç„¶åæˆ‘ä»¬æ¥è·å–æ•°æ®ï¼Œè¿™é‡Œçš„è¯æˆ‘ç”¨çš„æ˜¯Alamofireè¿›è¡Œçš„ç½‘ç»œè¯·æ±‚ï¼ŒURLä¸æ–¹ä¾¿é€éœ²

//è·å–æ•°æ®
func getData(){
    Alamofire.request(.GET, GoodsUrl).responseJSON() { (req, _, JSON, _) -> Void in

        if let j = JSON as? NSDictionary{
            var data = j.valueForKey("data")as! NSArray

            for dict in data{
                var model = GoodsModel()
                model.Analytical(dict as! NSDictionary)
                self.dataArr.addObject(model)
            }

            self.colltionView!.reloadData()
        }
    }
}
æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹ä¸‹cellé‡Œé¢ç©¶ç«Ÿå†™äº†äº›ä»€ä¹ˆç©æ„

class Home_Cell: UICollectionViewCell {

    let width = UIScreen.mainScreen().bounds.size.width//è·å–å±å¹•å®½
    var imgView : UIImageView?//cellä¸Šçš„å›¾ç‰‡
    var titleLabel:UILabel?//cellä¸Štitle
    var priceLabel:UILabel?//cellä¸Šä»·æ ¼
    var readLabel:UILabel?//cellä¸Šçš„é˜…è¯»é‡


override init(frame: CGRect) {

    super.init(frame: frame)
    //åˆå§‹åŒ–å„ç§æ§ä»¶
    imgView = UIImageView(frame: CGRectMake(0, -10, (width-30)/2, 200))
    self .addSubview(imgView!)
    titleLabel = UILabel(frame: CGRectMake(5, CGRectGetMaxY(imgView!.frame)-12, (width-40)/2, 50))
    titleLabel?.numberOfLines = 0
    titleLabel?.font = UIFont.boldSystemFontOfSize(14.0)
    titleLabel?.textColor = UIColor.lightGrayColor()
    self .addSubview(titleLabel!)

    priceLabel = UILabel(frame: CGRectMake(5, CGRectGetMaxY(titleLabel!.frame), (width-40)/2/2, 20))
    priceLabel?.numberOfLines = 0
    priceLabel?.font = UIFont.boldSystemFontOfSize(14.0)
    priceLabel?.textColor = UIColor.lightGrayColor()
    self .addSubview(priceLabel!)

    readLabel = UILabel(frame: CGRectMake((width-30)/2/2, CGRectGetMaxY(titleLabel!.frame), (width-40)/2/2, 20))
    readLabel?.numberOfLines = 0
    readLabel?.textAlignment = NSTextAlignment.Right
    readLabel?.font = UIFont.boldSystemFontOfSize(14.0)
    readLabel?.textColor = UIColor.lightGrayColor()
    self .addSubview(readLabel!)


}

required init(coder aDecoder: NSCoder) {
    fatalError("init(coder:) has not been implemented")
}

}
æ˜¯ä¸æ˜¯è¿˜è§‰å¾—ç¼ºå°‘ç‚¹ä»€ä¹ˆï¼Ÿæ²¡é”™ï¼Œæˆ‘ä»¬çš„headviewæ˜¯ä¸æ˜¯è¿˜æ²¡æ•´å•Šï¼Ÿ
æ¥ä¸‹æ¥å‘¢ï¼Œæˆ‘ä»¬çœ‹ä¸‹UICollectionViewçš„headviewè¯¥æ€ä¹ˆè®¾ç½®
é‡ç‚¹åœ¨è¿™é‡Œï¼é¦–å…ˆheadviewè¦ç»§æ‰¿UICollectionReusableView
ç„¶åæˆ‘ä»¬è¿™ä¸ª.mæ–‡ä»¶é‡Œé¢å¹¶æ²¡æœ‰çœ‹åˆ°override func viewDidLoad()è¿™æ ·çš„æ–¹æ³•
é‚£æˆ‘ä»¬æ€ä¹ˆåŠå‘¢ï¼Ÿ
æ¥ä¸‹æ¥å°±çœ‹æˆ‘çš„äº†
æˆ‘ä»¬ç‚¹åˆ°æˆ‘ä»¬ç»§æ‰¿çš„UICollectionReusableViewé‡Œé¢å»çœ‹é‡Œé¢æœ‰äº›ä»€ä¹ˆæ–¹æ³•
åŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼ŒğŸ˜„ç»ˆäºæ‰¾åˆ°äº†ä¸€ä¸ªå¯ä»¥è®©æˆ‘ä»¬ç”¨çš„æ–¹æ³•

override func applyLayoutAttributes(layoutAttributes: UICollectionViewLayoutAttributes!){

}
æˆ‘ä»¬å¯ä»¥æŠŠè¦è‡ªå®šä¹‰çš„UI è¯·æ±‚æ•°æ®ä»€ä¹ˆçš„éƒ½æ”¾è¿™æ–¹æ³•é‡Œé¢
ä¹Ÿå°±ç›¸å½“äºæˆ‘ä»¬VCé‡Œé¢çš„override func viewDidLoad()è¿™ä¸ªæ–¹æ³•
æ•™ç¨‹åˆ°ç»“æŸ
æœ‰ä»»ä½•é—®é¢˜å¯ä»¥ç•™è¨€ï¼Œå®šæœŸæŠ½æ—¶é—´å›å¤

ç‰ˆæƒå½’Â©Bisonæ‰€æœ‰ ä»»ä½•è½¬è½½è¯·æ ‡æ˜å‡ºå¤„ï¼

æ›´å¤šç»éªŒè¯·ç‚¹å‡»
åšä¸»appä¸Šçº¿äº†ï¼Œèµ¶ç´§ç‚¹æ­¤æ¥å›´è§‚å§ğŸ˜„

>æœ€ç»ˆæ•ˆæœå›¾å¦‚ä¸‹
(LBPersonalPageDemo)
<!-- markdown end -->
</div>
<div class="entry" id="main">
<!-- content -->
<p>ï¼ˆæ³¨æ˜ï¼šåŸæ–‡å‡ºè‡ªhttp://allluckly.cn/ios%E4%B9%8Bswift%E5%88%9D%E6%8E%A2/Swift%E7%BA%AF%E4%BB%A3%E7%A0%81%E8%B5%B0%E8%BF%9BUICollectionViewï¼Œè°¢è°¢ä½œè€…çš„æ— ç§åˆ†äº«ï¼Œè°¢è°¢ï¼ï¼‰
Swiftå¯¹äºä¸€é—¨æ–°çš„iOSç¼–ç¨‹è¯­è¨€ï¼Œä»–çš„å´›èµ·æ˜¯å¿…ç„¶çš„</p>

<p>æˆ‘ä»¬è¿™ç¾¤è€ç¨‹åºå‘˜ä»¬å­¦ä¹ æ–°çš„æŠ€èƒ½ä¹Ÿæ˜¯å¿…ç„¶çš„</p>

<p>ä¸æ¥å—æ–°æŠ€èƒ½å°†è¢«è¿™å¤§ç¾¤ä½“æ— æƒ…çš„æ·˜æ±°</p>

<p>So æˆ‘æ¬£ç„¶æ¥å—è¿™é—¨çœ‹ä¼¼ä¸æˆç†Ÿçš„è¯­è¨€</p>

<p>ä¸‹é¢æˆ‘ä»¬è¯´è¯´Swiftä¸­æ¯”è¾ƒå¸¸è§çš„æ§ä»¶UICollectionView</p>

<p>é¦–å…ˆæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªå…¨å±€çš„UICollectionViewå’Œä¸€ä¸ªæ•°æ®æº</p>

<p>var colltionView : UICollectionView?
var dataArr = NSMutableArray()</p>

<p>ç„¶åè®¾ç½®UICollectionViewçš„3ä¸ªä»£ç†
UICollectionViewDelegate,UICollectionViewDataSource,UICollectionViewDelegateFlowLayout
æ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„æ˜¯override func viewDidLoad()æ–¹æ³•ä¸­åˆå§‹åŒ–ä¸€äº›å¿…è¦çš„å¯¹è±¡</p>

<p>override func viewDidLoad() {
    super.viewDidLoad()
    var layout = UICollectionViewFlowLayout()
    colltionView = UICollectionView(frame: CGRectMake(0, 0, width, height), collectionViewLayout: layout)
    //æ³¨å†Œä¸€ä¸ªcell
    colltionView! .registerClass(Home<em>Cell.self, forCellWithReuseIdentifier:"cell")
    //æ³¨å†Œä¸€ä¸ªheadView
    colltionView! .registerClass(Home</em>HeadView.self, forSupplementaryViewOfKind:UICollectionElementKindSectionHeader, withReuseIdentifier: "headView")
    colltionView?.delegate = self;
    colltionView?.dataSource = self;</p>

<pre><code>colltionView?.backgroundColor = UIColor.whiteColor()
//è®¾ç½®æ¯ä¸€ä¸ªcellçš„å®½é«˜
layout.itemSize = CGSizeMake((width-30)/2, 250)
self.view .addSubview(colltionView!)
self .getData()
</code></pre>

<p>}
ç„¶åæˆ‘ä»¬å®ç°UICollectionViewçš„ä»£ç†æ–¹æ³•</p>

<p>//è¿”å›å¤šå°‘ä¸ªç»„
func numberOfSectionsInCollectionView(collectionView: UICollectionView) -&gt; Int {</p>

<pre><code>return 1
</code></pre>

<p>}
//è¿”å›å¤šå°‘ä¸ªcell
func collectionView(collectionView: UICollectionView, numberOfItemsInSection section: Int) -&gt; Int {
    return dataArr.count
}
//è¿”å›è‡ªå®šä¹‰çš„cell
func collectionView(collectionView: UICollectionView, cellForItemAtIndexPath indexPath: NSIndexPath) -&gt; UICollectionViewCell {</p>

<pre><code>let cell = collectionView.dequeueReusableCellWithReuseIdentifier("cell", forIndexPath: indexPath) as! Home_Cell
var model = GoodsModel()
model = dataArr[indexPath.row] as! GoodsModel
let url : NSURL = NSURL(string: model.image_url as String)!
cell.imgView!.hnk_setImageFromURL(url)
cell.layer.borderWidth = 0.3;
cell.layer.borderColor = UIColor.lightGrayColor().CGColor
cell.titleLabel!.text = model.short_name
cell.priceLabel!.text = "ï¿¥"+model.p_price
cell.readLabel!.text = "ğŸ’—"+model.like_count
return cell
</code></pre>

<p>}
//è¿”å›HeadViewçš„å®½é«˜
func collectionView(collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, referenceSizeForHeaderInSection section: Int) -&gt; CGSize{</p>

<pre><code>return CGSize(width: width, height: height/1.6)
</code></pre>

<p>}</p>

<p>//è¿”å›è‡ªå®šä¹‰HeadViewæˆ–è€…FootViewï¼Œæˆ‘è¿™é‡Œä»¥headviewä¸ºä¾‹
func collectionView(collectionView: UICollectionView, viewForSupplementaryElementOfKind kind: String, atIndexPath indexPath: NSIndexPath) -&gt; UICollectionReusableView{
    var v = Home_HeadView()
    if kind == UICollectionElementKindSectionHeader{</p>

<pre><code>v = colltionView!.dequeueReusableSupplementaryViewOfKind(kind, withReuseIdentifier: "headView", forIndexPath: indexPath) as! Home_HeadView
}
return v
</code></pre>

<p>}
//è¿”å›cell ä¸Šä¸‹å·¦å³çš„é—´è·
func collectionView(collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, insetForSectionAtIndex section: Int) -&gt; UIEdgeInsets{
    return UIEdgeInsetsMake(5, 10, 5, 10)
}
ç„¶åæˆ‘ä»¬æ¥è·å–æ•°æ®ï¼Œè¿™é‡Œçš„è¯æˆ‘ç”¨çš„æ˜¯Alamofireè¿›è¡Œçš„ç½‘ç»œè¯·æ±‚ï¼ŒURLä¸æ–¹ä¾¿é€éœ²</p>

<p>//è·å–æ•°æ®
func getData(){
    Alamofire.request(.GET, GoodsUrl).responseJSON() { (req, _, JSON, _) -&gt; Void in</p>

<pre><code>    if let j = JSON as? NSDictionary{
        var data = j.valueForKey("data")as! NSArray

        for dict in data{
            var model = GoodsModel()
            model.Analytical(dict as! NSDictionary)
            self.dataArr.addObject(model)
        }

        self.colltionView!.reloadData()
    }
}
</code></pre>

<p>}
æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹ä¸‹cellé‡Œé¢ç©¶ç«Ÿå†™äº†äº›ä»€ä¹ˆç©æ„</p>

<p>class Home_Cell: UICollectionViewCell {</p>

<pre><code>let width = UIScreen.mainScreen().bounds.size.width//è·å–å±å¹•å®½
var imgView : UIImageView?//cellä¸Šçš„å›¾ç‰‡
var titleLabel:UILabel?//cellä¸Štitle
var priceLabel:UILabel?//cellä¸Šä»·æ ¼
var readLabel:UILabel?//cellä¸Šçš„é˜…è¯»é‡
</code></pre>

<p>override init(frame: CGRect) {</p>

<pre><code>super.init(frame: frame)
//åˆå§‹åŒ–å„ç§æ§ä»¶
imgView = UIImageView(frame: CGRectMake(0, -10, (width-30)/2, 200))
self .addSubview(imgView!)
titleLabel = UILabel(frame: CGRectMake(5, CGRectGetMaxY(imgView!.frame)-12, (width-40)/2, 50))
titleLabel?.numberOfLines = 0
titleLabel?.font = UIFont.boldSystemFontOfSize(14.0)
titleLabel?.textColor = UIColor.lightGrayColor()
self .addSubview(titleLabel!)

priceLabel = UILabel(frame: CGRectMake(5, CGRectGetMaxY(titleLabel!.frame), (width-40)/2/2, 20))
priceLabel?.numberOfLines = 0
priceLabel?.font = UIFont.boldSystemFontOfSize(14.0)
priceLabel?.textColor = UIColor.lightGrayColor()
self .addSubview(priceLabel!)

readLabel = UILabel(frame: CGRectMake((width-30)/2/2, CGRectGetMaxY(titleLabel!.frame), (width-40)/2/2, 20))
readLabel?.numberOfLines = 0
readLabel?.textAlignment = NSTextAlignment.Right
readLabel?.font = UIFont.boldSystemFontOfSize(14.0)
readLabel?.textColor = UIColor.lightGrayColor()
self .addSubview(readLabel!)
</code></pre>

<p>}</p>

<p>required init(coder aDecoder: NSCoder) {
    fatalError("init(coder:) has not been implemented")
}</p>

<p>}
æ˜¯ä¸æ˜¯è¿˜è§‰å¾—ç¼ºå°‘ç‚¹ä»€ä¹ˆï¼Ÿæ²¡é”™ï¼Œæˆ‘ä»¬çš„headviewæ˜¯ä¸æ˜¯è¿˜æ²¡æ•´å•Šï¼Ÿ
æ¥ä¸‹æ¥å‘¢ï¼Œæˆ‘ä»¬çœ‹ä¸‹UICollectionViewçš„headviewè¯¥æ€ä¹ˆè®¾ç½®
é‡ç‚¹åœ¨è¿™é‡Œï¼é¦–å…ˆheadviewè¦ç»§æ‰¿UICollectionReusableView
ç„¶åæˆ‘ä»¬è¿™ä¸ª.mæ–‡ä»¶é‡Œé¢å¹¶æ²¡æœ‰çœ‹åˆ°override func viewDidLoad()è¿™æ ·çš„æ–¹æ³•
é‚£æˆ‘ä»¬æ€ä¹ˆåŠå‘¢ï¼Ÿ
æ¥ä¸‹æ¥å°±çœ‹æˆ‘çš„äº†
æˆ‘ä»¬ç‚¹åˆ°æˆ‘ä»¬ç»§æ‰¿çš„UICollectionReusableViewé‡Œé¢å»çœ‹é‡Œé¢æœ‰äº›ä»€ä¹ˆæ–¹æ³•
åŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼ŒğŸ˜„ç»ˆäºæ‰¾åˆ°äº†ä¸€ä¸ªå¯ä»¥è®©æˆ‘ä»¬ç”¨çš„æ–¹æ³•</p>

<p>override func applyLayoutAttributes(layoutAttributes: UICollectionViewLayoutAttributes!){</p>

<p>}
æˆ‘ä»¬å¯ä»¥æŠŠè¦è‡ªå®šä¹‰çš„UI è¯·æ±‚æ•°æ®ä»€ä¹ˆçš„éƒ½æ”¾è¿™æ–¹æ³•é‡Œé¢
ä¹Ÿå°±ç›¸å½“äºæˆ‘ä»¬VCé‡Œé¢çš„override func viewDidLoad()è¿™ä¸ªæ–¹æ³•
æ•™ç¨‹åˆ°ç»“æŸ
æœ‰ä»»ä½•é—®é¢˜å¯ä»¥ç•™è¨€ï¼Œå®šæœŸæŠ½æ—¶é—´å›å¤</p>

<p>ç‰ˆæƒå½’Â©Bisonæ‰€æœ‰ ä»»ä½•è½¬è½½è¯·æ ‡æ˜å‡ºå¤„ï¼</p>

<p>æ›´å¤šç»éªŒè¯·ç‚¹å‡»
åšä¸»appä¸Šçº¿äº†ï¼Œèµ¶ç´§ç‚¹æ­¤æ¥å›´è§‚å§ğŸ˜„</p>

<blockquote>
  <p>æœ€ç»ˆæ•ˆæœå›¾å¦‚ä¸‹
  (LBPersonalPageDemo)</p>
</blockquote>
<!-- content end -->
</div>
<br>
<br>
    <div id="disqus_thread"></div>
	<div class="footer">
		<p>Â© Copyright 2014 by isnowfy, Designed by isnowfy</p>
	</div>
</div>
<script src="main.js"></script>
<script id="content" type="text/mustache">
    <h1>{{title}}</h1>
    <div class="tag">
    {{date}}
    {{#tags}}
    <a href="/#/tag/{{name}}">#{{name}}</a>
    {{/tags}}
    </div>
</script>
<script id="pagesTemplate" type="text/mustache">
    {{#pages}}
    <li>
        <a href="{{path}}">{{title}}</a>
    </li>
    {{/pages}}
</script>
<script>
$(document).ready(function() {
    $.ajax({
        url: "main.json",
        type: "GET",
        dataType: "json",
        success: function(data) {
            $("#title").html(data.name);
            var pagesTemplate = Hogan.compile($("#pagesTemplate").html());
            var pagesHtml = pagesTemplate.render({"pages": data.pages});
            $("#pages").append(pagesHtml);
            //path
            var path = "0805.html";
            //path end
            var now = 0;
            for (var i = 0; i < data.posts.length; ++i)
                if (path == data.posts[i].path)
                    now = i;
            var post = data.posts[now];
            var tmp = post.tags.split(" ");
            var tags = [];
            for (var i = 0; i < tmp.length; ++i)
                if (tmp[i].length > 0)
                    tags.push({"name": tmp[i]});
            var contentTemplate = Hogan.compile($("#content").html());
            var contentHtml = contentTemplate.render({"title": post.title, "tags": tags, "date": post.date});
            $("#main").prepend(contentHtml);
            if (data.disqus_shortname.length > 0) {
                var disqus_shortname = data.disqus_shortname;
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            }
        }
    });
});
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ["\\(", "\\)"]], processEscapes: true}});
</script>
</body>
</html>
